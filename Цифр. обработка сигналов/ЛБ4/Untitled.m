n = 4;
f1 = 20;
f2 = 50;
fs = f2 * 2 + 10;
t = (1:100) / fs;
s1 = sin(2 * pi * t * f1);
s2 = sin(2 * pi * t * f2);
s = s1 + s2;
subplot(3, 2, 1);
plot(t, s1);
subplot(3, 2, 3);
plot(t, s2);
subplot(3, 2, 2);
plot(t, s);
w0 = f2 * 2 / fs;
[b, a] = butter(n, w0, 'high');
[h, w] = freqz(b, a);
subplot(3, 2, 4);
plot(w * fs / (2 * pi), abs(h));
sf = filter(b, a, s);
subplot(3, 2, 6);
plot(t, sf);
